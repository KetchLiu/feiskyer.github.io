---
title: 云原生（Cloud Native）
date: 2016-10-13 22:48:12
---

云原生能帮助企业高效、快速、稳定、大量地完成软件交付工作。持续交付、开发运维一体化（DevOps）、微服务是云原生为何如此关键的三个重要原因。这三大要素相互交织，不可分离的。云原生既有利于塑造团结信任的企业文化，又能有效利用自动化提升工作效率，让良好的运营促进公司更快更稳定地发展。

cloud-native应用的本质是它们满足如下特点的契约：通过可预测的行为，最大化复原。云平台使用的高度自动化、容器驱动的基础设施，引领软件的编写方式。开发者必须改变编码方式，在开发者和运行应用的基础设施之间建立一种新的契约。一个很好的契约例子是十二因素应用。

其中，大多数因素的内容有重叠，相互补充。这些因素的描述尽量保证直接和可操作：

- 从一个代码库部署到多个环境——一个代码库，包括生产环境软件包，确保了单一的信任源，从而保证了更少的配置错误和更强的容错和复原能力。
- 依赖管理是声明式的——云平台根据这些声明管理依赖，确保云应用所需的库和服务。
- 配置信息保存在环境中——环境变量是一种清楚、容易理解和标准化的配置方法，特别适合用不同编程语言编写的无状态应用的使用。
- 将后台服务视为附加的资源——将每一种资源都视为一种远程的资源，应用因此具有容错和复原能力，因为它一方面要求编码时就要考虑资源不可用的情况，另外一方面也增强微服务方法的好处。
- 区分构建、发布和运行阶段——cloud-native应用的构建流程把大部分发布配置挪到开发阶段，包括实际的代码构建和运行应用所需的生产环境配置。
- 作为无状态进程运行——尽量保持应用栈每一层的轻量级，保证cloud-native基础设施的速度和效率。
- 通过端口绑定对外暴露服务——cloud-native应用的服务接口优先选择 HTTP API 作为通用的集成框架。
- 通过添加无状态进程实现横向扩展——强调无状态、无共享的设计，这意味着依赖底层平台就能实现横向扩展，不需要技术难度高的多线程编码。
- 快速地启动，优雅地关停——假设任何进程随时都能启动和关停。
- 开发、预发布和生产环境运行同样的应用和依赖配置——由于强调自动化和在每个阶段使用同一个云平台，如果每个人用同样的服务器配置，那么“应用在我这里是可以的”就意味着在其他人或者环境那里也是可以的。
- 日志输出到标准输出，方便日志聚合和事件响应——当日志是由云平台而不是应用包含的库处理时，日志处理机制必须保持简单。
- 临时任务作为短时进程运行——在cloud-native中，管理任务也是一个进程，而不是特别的工具；同样重要的是，管理任务的进程不应使用秘密的 API 或者内部机制。

自动化

1.  路由和负载均衡——应用的横向扩展需要网络路由，路由是可以动态更新的，它把外来请求分散到整个资源池。
2.  后台服务代理——大部分应用都需要各种后台服务，包括数据库、缓存和消息队列。这些服务必须是高可用的服务，通过环境变量进行配置，以便满足十二因素约定中对配置的要求。
3.  基础设施编排——平台必须能自动管理基础设施，提供弹性扩展的计算资源。
4.  健康管理、监控和恢复——可视化显示正在运行的应用和实例，以及当事件发生时的通知消息和审计日志。
5.  可复用的运行时环境仓库——应用以容器镜像的形式发布，重复用于启动应用实例，这保证了整个架构同一个应用的所有实例是完全一样的。
6.  日志聚合——高可用、横向扩展的应用需要聚合所有实例的日志，用于分析和响应发生的事故。

![1](/images/1.png)

![2](/images/2.png)

![3](/images/3.png)

![4](/images/4.png)

[1] https://d1fto35gcfffzn.cloudfront.net/cloud-native/infographic/Pivotal-The-Journey-to-Cloud-Native.pdf


